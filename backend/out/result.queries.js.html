<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: result.queries.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: result.queries.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Result = require('../database/models/result.model')
const { calculResult } = require('../config/evaluation.config')

// A COMPLETER EN MEME TEMPS QUE LA FONCTION
/**
 * getResult.
 * @param {}  - 
 * @returns {object} Return a object with data result.
 */

exports.getResult = () => {
  return Result.find().populate('user').exec()
    .then(result => console.log(result))
}

/**
 * getCurrentResult.
 * @param {string} evaluationId - Evaluation ID.
 * @returns {object} Return a object with evaluation data.
 */

exports.getCurrentResult = async (evaluationId) => {
  const currentEvaluation = await Result.findById({ _id: evaluationId }, (err, evaluation) => {
    return evaluation
  })
  return currentEvaluation
}

/**
 * addEvaluation. Add new evaluation in database.
 * @param {object} body - Contains evaluation datas
 * @param {string} userID - User ID.
 * @returns {object} Return a object with evaluation data.
 */

exports.addEvaluation = async (body, userID) => {
  const { start, arrival, carburant, emission } = body
  try {
    const result = await calculResult(body)
    const newEvaluation = new Result({
      impact: result.impact,
      itinerary: {
        from: start,
        to: arrival,
        numberKm: result.distance
      },
      vehicle: {
        fuelType: carburant,
        emission: emission
      },
      equivalents: {
        treeToPlant: result.treeToPlant,
        numberTel: result.numberTel
      },
      user_id: userID
    })
    return newEvaluation.save()
  } catch (error) {
    throw error
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addEvaluation">addEvaluation</a></li><li><a href="global.html#getCurrentResult">getCurrentResult</a></li><li><a href="global.html#getResult">getResult</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Fri Jul 31 2020 13:32:54 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
